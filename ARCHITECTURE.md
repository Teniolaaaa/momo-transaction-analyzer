# System Architecture

## Overview
This document describes the architecture of the MoMo Transaction Analyzer system.

## Architecture Diagram

```
┌─────────────────────────────────────────────────────────────────┐
│                        USER INTERFACE                            │
│                      (Web Dashboard)                             │
│                                                                   │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │  Summary     │  │ Transaction  │  │   Filters    │          │
│  │   Cards      │  │    Table     │  │   & Search   │          │
│  └──────────────┘  └──────────────┘  └──────────────┘          │
└───────────────────────────────┬─────────────────────────────────┘
                                │
                                │ HTTP Request
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                      FRONTEND LAYER                              │
│                                                                   │
│  index.html  +  styles.css  +  chart_handler.js                 │
│                                                                   │
│  • Fetches dashboard.json                                        │
│  • Renders transaction data                                      │
│  • Formats RWF currency                                          │
└───────────────────────────────┬─────────────────────────────────┘
                                │
                                │ Reads JSON
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                      DATA LAYER                                  │
│                                                                   │
│  dashboard.json (Processed Data)                                 │
│  • Total transactions                                            │
│  • Total amounts                                                 │
│  • Categories                                                    │
│  • Recent transactions list                                      │
└───────────────────────────────┬─────────────────────────────────┘
                                │
                                │ Generated by
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                      ETL PIPELINE                                │
│                                                                   │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐       │
│  │   EXTRACT   │────▶│  TRANSFORM  │────▶│    LOAD     │       │
│  └─────────────┘     └─────────────┘     └─────────────┘       │
│                                                                   │
│  parse_xml.py        clean_normalize.py   load_db.py            │
│  • Read XML          • Clean amounts      • Insert to DB        │
│  • Validate data     • Fix dates          • Create tables       │
│                      • Standardize phones                        │
│                      categorize.py                               │
│                      • Assign categories                         │
└───────────────────────────────┬─────────────────────────────────┘
                                │
                                │ Stores in
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                      DATABASE LAYER                              │
│                                                                   │
│                    SQLite (db.sqlite3)                           │
│                                                                   │
│  transactions table:                                             │
│  • id, date, type, amount, phone, category, description          │
└───────────────────────────────┬─────────────────────────────────┘
                                │
                                │ Reads from
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                      DATA SOURCE                                 │
│                                                                   │
│               XML Transaction Files                              │
│               (data/raw/sample_momo.xml)                         │
│                                                                   │
│  <transaction>                                                   │
│    <id>TXN001</id>                                              │
│    <date>2024-01-17</date>                                      │
│    <amount>75000</amount>                                        │
│    <type>received</type>                                         │
│  </transaction>                                                  │
└─────────────────────────────────────────────────────────────────┘
```

## Component Description

### 1. Data Source Layer
- **Input:** XML files containing MoMo transaction data
- **Location:** `data/raw/`
- **Format:** Structured XML with transaction elements

### 2. ETL Pipeline Layer
The core data processing engine consisting of:

**Extract (parse_xml.py)**
- Parses XML transaction files
- Validates required fields (date, amount, type)
- Converts XML to Python dictionaries

**Transform (clean_normalize.py + categorize.py)**
- Removes currency symbols from amounts
- Normalizes date formats to YYYY-MM-DD
- Standardizes phone numbers with country codes
- Categorizes transactions (AIRTIME, TRANSFER, BILL_PAYMENT, etc.)

**Load (load_db.py)**
- Creates SQLite database tables
- Inserts cleaned transaction records
- Exports data to JSON for frontend

### 3. Database Layer
- **Technology:** SQLite3
- **Location:** `data/db.sqlite3`
- **Schema:** Single transactions table with all transaction fields
- **Purpose:** Persistent storage and data querying

### 4. Data Export Layer
- **Format:** JSON
- **Location:** `data/processed/dashboard.json`
- **Content:** Aggregated statistics and recent transactions
- **Purpose:** API endpoint for frontend

### 5. Frontend Layer
- **Technology:** HTML5, CSS3, Vanilla JavaScript
- **Components:**
  - Summary cards (transactions count, total amount, categories)
  - Transaction table with all records
  - Real-time currency formatting (RWF)
- **Communication:** Fetches JSON data via AJAX

### 6. User Interface
- **Access:** Web browser
- **Features:**
  - Responsive design
  - Interactive data display
  - Category filtering
  - Amount formatting

## Data Flow

1. User places XML file in `data/raw/`
2. User runs ETL pipeline: `python etl/run.py --xml data/raw/sample_momo.xml`
3. ETL extracts and validates XML data
4. ETL transforms and cleans data
5. ETL loads data into SQLite database
6. ETL exports summary to JSON file
7. User opens dashboard in browser
8. JavaScript fetches JSON data
9. Dashboard displays formatted transaction data

## Technology Stack

### Backend
- **Language:** Python 3.13
- **Libraries:** lxml, python-dateutil
- **Database:** SQLite3

### Frontend
- **Markup:** HTML5
- **Styling:** CSS3
- **Scripting:** JavaScript (ES6)

### Tools
- Git/GitHub for version control
- VS Code for development

## Security Considerations
- Local file system access only
- No network communication required
- SQLite database stored locally
- No user authentication (single user system)

## Scalability Notes
- Current design handles up to 10,000 transactions efficiently
- SQLite suitable for single-user desktop application
- For multi-user: Consider PostgreSQL/MySQL
- For web deployment: Add authentication and API layer

## Future Enhancements
- REST API layer for remote access
- User authentication system
- Real-time data updates
- Advanced analytics and charts
- Export to CSV/Excel functionality
